<!DOCTYPE html>
<html lang="en">
    <head>

        <!-- Webpage Title -->
        <title>Home | SWEETER</title>

        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bulma CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
        <!-- Font Awesome CSS -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/common.css') }}">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/detail.css') }}">
        
        
        <!-- JS -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
        <script>
          $(document).ready(function () {
            listing();
          });

          function listing(){
            $.ajax({
                type: 'GET',
                url: '/detail/<num>',
                data: {},
                success: function (response) {
                    let rows = response['review']
                    for (let i = 0; i < rows.length ; i++){
                        let review_comment = rows[i]['review_comment']
                        let grade = rows[i]['grade']
                        let nickname = rows[i]['nickname']
                        let star_img = '⭐'.repeat(star)

                        let temp_html = `
                        <div class="review-con wrap">
                          <div class="comments">
                            <p class="nick">${nickname} 님</p>
                            <div class="comment">
                              ${review_comment}
                            </div>
                          </div>
                          <div class="comments-right">
                            <div class="grade">${star_img}</div>
                            <a href="#">삭제</a>
                          </div>
                        </div>
                        <hr class="wrap">
                        `
                        $('#cards-box').append(temp_html)
                    }
                }
            })
          }

          function review_write(){
            let review_comment = $('#review-comment').val()
            let grade = $('#select-grade').val()
            let nickname = $('#nickname').text()

            $.ajax({
                type: 'POST',
                url: '/detail/<num>',
                data: { 
                  review_comment_give: review_comment,
                  grade_give: grade,
                  nickname_give: nickname
                },
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()
                }
            });  
          }


        </script>
        {% include 'head.html' %}
        

    </head>
    <body>
        <header>{% include 'header.html' %}</header>
        <section class="youtube">
          <iframe class="video" width="560" height="315" src="https://www.youtube.com/embed/8jmuLrP-KIA?autoplay=1&mute=1 " title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>   
        </script>
        </section>
        <section class="contents wrap">
          <p id="title" class="title">Tom Clancy's The Division 2</p>
          <div class="price">
            <p id="price" class="price">54,900 <span>원</span></p>
            <button class="buy-button" onclick="buy()">구매하기</button>
          </div>
        </section>
        <hr class="wrap">
        <div class="pd-detail wrap">
          <p class="game-title">게임 정보</p>
          <div id="disc" class="disc">
            치명적인 바이러스가 뉴욕을 비롯한 세계 곳곳을 강타하고 인류를 고통에 빠뜨린 지 7개월이 흘렀습니다. 바이러스가 발발하자 민간인으로 생활하던 디비전 요원들이 최후의 방어선 역할을 수행하기 위해 소집되었습니다. 그 후 지금까지 디비전 요원들은 남은 사람들을 구하기 위해 사투를 벌이고 있습니다.
            <br>
            <br>
            디비전 역사상, 그 어느 때보다 위험한 상황이 발생했습니다. 지구상에서 가장 철통같은 방어선을 자랑하는 도시, 워싱턴 D.C.가 위험에 빠지며 국가 전역이 무너질 위기에 처한 것입니다. 워싱턴 D.C.를 잃는다면 국가가 무너지고 맙니다. 7개월이라는 기간 동안 현장에 머물던 디비전 요원인 당신과 팀원들이 전염병 이후 사회의 붕괴를 막을 마지막 희망입니다.
            <br>
            <br>
            Ubisoft Massive와 `톰 클랜시의 디비전`제작진이 개발한 `톰 클랜시의 디비전 2`는 파괴된 워싱턴 D.C.를 배경으로 하는 오픈 월드, 액션 슈팅 RPG 게임입니다. 아름답고 상징적이면서 사실적인 환경과 다채롭고 새로운 설정을 결합하여, 플레이어는 실제와 같은 건물, 풍부한 RPG 시스템, 빠른 속도의 액션으로 이루어진 동일 시리즈의 정수를 경험할 수 있습니다. 단독 모드 또는 최대 4명의 플레이어와 팀을 이룬 협동 모드를 통해 메인 캠페인부터 한순간의 방심도 용납하지 않는 PvP 모드, 다크존 임무까지 다양한 활동을 수행할 수 있습니다.
          </div>
        </div>
        <hr class="wrap">
        <p class="review-title wrap">리뷰</p>
        <div class="review-write wrap">
          <textarea id="review-comment" class="review-comment" cols="30" rows="10"></textarea>
          <div class="select is-normal" >
            <select id ="select-grade">
                <option value="5">⭐⭐⭐⭐⭐</option>
                <option value="4">⭐⭐⭐⭐</option>
                <option value="3">⭐⭐⭐</option>
                <option value="2">⭐⭐</option>
                <option value="1">⭐</option>
            </select>
          </div>
          <button class="review-button" onclick="review_write()">리뷰 작성</button>
        </div>
        <div class="review" id="review">
        </div>
        <footer></footer>
    </body>
</html>